\section{Einführung}
AWS IoT \cite{iot} ist einer der neueren Web Services von Amazon, welcher zunächst im Oktober 2015 in eine Beta Phase gestartet ist und seit Januar 2016 in den regulären Betrieb gewechselt ist. Es ist eine verwaltete Cloud Plattform, mit der verbundene Geräte mit Cloud Anwendungen und anderen Geräten zusammenarbeiten können. \newline
AWS IoT kann Millionen von Nachrichten von typischen IoT Geräten wie bspw. Sensoren annehmen und an weitere Amazon Web Services oder andere IoT Geräte verteilen. Dies bietet zum einen die Möglichkeit der Kommunikation von IoT Geräten untereinander sowie die Möglichkeit der IoT Geräte mit der Cloud zu kommunizieren um beispielsweise Daten zu übermitteln, die dann in Cloud Services verarbeitet und/oder persistiert werden. Beispiele wären zum Beispiel ein Temperatursensor, der mittels AWS IoT der Klimaanlage des Hauses die Nachricht übermittelt, dass die Temperatur höher geregelt werden muss oder der Temperatursensor schickt seine Temperaturdaten an andere Amazon Web Services wie bspw. Amazon DynamoDB, welches die Daten dann persistieren kann. Amazon nennt als Beispiel eine Reihe von Temperatursensoren, die ihre Daten an AWS IoT senden. AWS IoT sendet dann bei Überschreiten eines bestimmten Grenzwertes ein Kommando an einen Ventilator im Haus, der sich daraufhin einschaltet. Der Ventilator kann aber auch bspw. über eine Mobilapplikation von einem Benutzer über AWS IoT manuell gestartet werden (s. Abbildung \ref{fig:iot_authentication}).
\begin{figure}[h!]
	
	\includegraphics[width=1.0\textwidth]{content/images/IoT_Authentication.png}
	
	\caption{Kommunikation und Authentifikation von Temperatursensoren und einem Ventilator mit AWS IoT. Quelle: \cite{iot}}
	
	\label{fig:iot_authentication}
	
\end{figure}
Dementsprechend ist AWS IoT eine gute Alternative, sollte man dieses Projekt mit echten Temperatursensoren ausführen wollen.
\section{Funktionsweise}
Ein wichtiger Punkt bei AWS IoT ist die Sicherheit der Kommunikation zwischen den einzelnen Endpunkten. Sicherheit ist bei IoT generell ein großes Thema, da unter Umständen mit sensiblen Daten gearbeitet wird, die im eigenen Haus erzeugt werden. AWS IoT stellt sicher, dass keine Kommunikation über AWS IoT unverschlüsselt stattfindet, indem sich jeder Endpunkt zunächst bei AWS IoT authentifizieren muss. Jede Kommunikation wird einzeln authentifiziert und verschlüsselt. Dies sieht man z.B. in Abbildung  \ref{fig:iot_authentication}. Hier wird in Schritt 2 die Kommunikation der Temperatursensoren mit AWS IoT authentifiziert, bevor sie die Daten an AWS IoT senden. In Schritt 4 wird die Kommunikation mit dem Ventilator ebenfalls zunächst authentifiziert. Und natürlich können nur authentifizierte Nutzer über Mobilapplikationen über AWS IoT wie in diesem Beispiel den Ventilator kontrollieren.
\begin{figure}[h!]
	
	\includegraphics[width=1.1\textwidth]{content/images/IoT_Functions.png}
	
	\caption{Funktionsübersicht von AWS IoT. Quelle: \cite{iot_functions}}
	
	\label{fig:iot_functions}
	
\end{figure}

Abbildung \ref{fig:iot_functions} zeigt eine Funktionsübersicht von AWS IoT. Hier steht zunächst einmal auf der linken Seite die AWS Device SDK, die eine Reihe von Client Libraries bereitstellt, mit der Geräte mit AWS IoT kommunizieren können. Die Kommunikation findet dabei über die Protokolle MQTT \cite{mqtt} oder HTTP statt. MQTT ist ein leichtgewichtiges Nachrichtenprotokoll für die direkte Kommunikation zwischen Maschinen (M2M) und ist daher ein häufig genutztes Protokoll im Bereich des IoT. Mittels einem dieser beiden Protokolle kommuniziert das Gerät, das die AWS Service SDK nutzt, mit dem Device Gateway. Die Kommunikation wird dabei verschlüsselt und zunächst müssen sich beide Seiten auch authentifizieren, bevor überhaupt eine Kommunikation zustande kommt. AWS IoT unterstützt dabei die AWS-Methode der Authentifizierung (mit der Bezeichnung ``SigV4'') sowie eine Authentifizierung auf der Basis von X.509 \cite{iot_functions}. Den Geräten können einzelne Richtlinien vorgegeben werden, die ihren Zugriff entsprechend einschränken oder es können Rollen definiert werden, die Geräten eine genau spezifizierte Menge an Rechten geben. \newline
Die Registry erstellt eine eindeutige Identität für die Geräte. Diese ist für alle Geräte egal welcher Art einheitlich formatiert. Außerdem werden Metadaten von Geräten gespeichert, die bspw. angeben, welche Funktionen dieses Gerät unterstützt wie zum Beispiel, dass ein Sensor Temperaturdaten meldet und in welcher Einheit diese Temperaturdaten übermittelt werden. \newline
Das Device Gateway stellt für Applikationen REST APIs bereit, über die die Applikationen die Statusinformationen von Geräten auslesen und manipulieren können. Dazu legt das Device Gateway sogenannte ``Device Shadows'' bzw. ``Schattengeräte'' an, die den letzten Zustand des Gerätes darstellen. Das heißt, dass der Zustand von Geräten auch dann ausgelesen werden kann, wenn das Gerät gar nicht mehr online ist, da der letzte Zustand als ``Schattengerät'' gespeichert wurde. Zudem können Applikationen so auch den gewünschten zukünftigen Zustand festlegen. Auch dieser wird im ``Schattengeräte'' persistiert und wird auf das Gerät übertragen, wenn es wieder online ist. Damit ist es möglich, auch für Geräte, die nicht dauerhaft online sind, eine REST API bereitzustellen, die dauerhaft verfügbar ist und Applikationen ermöglicht, sich immer mit dem ``Schattengerät'' zu synchronisieren und den Status zu verändern. Die Kommunikation erfolgt auch hier wieder über verschlüsselte Nachrichten. \newline
Das Device Gateway kann aber auch über die Rules Engine Daten von Geräten transformieren und an andere Services weiterleiten. So könnten beispielsweise Temperaturdaten an Amazon DynamoDB oder andere Datenbank Services weitergeleitet werden. Es können aber auch Regeln erstellt werden, die bei bestimmten Konditionen Aktionen auslösen. Zum Beispiel könnte beim Überschreiten einer bestimmten Menge an Temperaturen eine Nachricht an AWS Lambda \cite{lambda} geschickt werden, das daraufhin den Mittelwert der gesammelten Daten berechnet. Nachrichten können aber auch an Geräte geschickt werden wie in Abbildung \ref{fig:iot_authentication}. Erreicht die Temperatur der Sensoren einen Grenzwert, greift eine Regel und sendet den Befehl an den Ventilator, der sich daraufhin einschaltet. \newline
Die Regeln werden direkt in der Management Konsole eingetragen oder über eine SQL-ähnliche Syntax definiert.  \newline
AWS IoT bietet also passende Funktionen, um das Projekt mit echten Temperatursensoren umzusetzen. Man könnte die Temperaturdaten direkt an einen Datenbank Service wie Amazon DynamoDB weiterleiten und auch die Temperatursensoren über die REST API direkt steuern. Mittels der Rules Engine könnten Regeln festgelegt werden, nach denen bei bestimmten Temperaturen bestimmte Aktionen ausgeführt werden können. Dadurch könnte man auch andere Geräte wie beispielsweise Ventilatoren oder Klimaanlagen einbinden und mittels AWS IoT steuern lassen. Man benötigt aber neben den Sensoren auch Mikrocontroller wie bspw. Raspberry PIs \cite{raspberry}, die mit den Sensoren und anderen Geräten kommunizieren können, um AWS IoT nutzen zu können.  \newline \newline


\section{AWS IoT SDK}